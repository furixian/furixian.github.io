<!DOCTYPE html>
<html>
  <head>
    <title>Rock Paper Scissors Game</title>
    <style>
      button {
        font-size: 24px;
        padding: 10px 20px;
        margin: 10px;
      }
      #result {
        font-size: 32px;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Rock Paper Scissors Game</h1>
    <p>Choose your weapon:</p>
    <button id="rock">Rock</button>
    <button id="paper">Paper</button>
    <button id="scissors">Scissors</button>
    <p id="result"></p>
    
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
      
      document.getElementById("rock").addEventListener("click", function() {
        socket.emit("weapon", "rock");
      });
      
      document.getElementById("paper").addEventListener("click", function() {
        socket.emit("weapon", "paper");
      });
      
      document.getElementById("scissors").addEventListener("click", function() {
        socket.emit("weapon", "scissors");
      });
      
      socket.on("result", function(result) {
        document.getElementById("result").innerHTML = result;
      });
    </script>
  </body>
</html>

<script>
var express = require("express");
var app = express();
var server = require("http").createServer(app);
var io = require("socket.io")(server);

app.use(express.static(__dirname + "/public"));

var players = []; // array of connected players
var weapons = ["rock", "paper", "scissors"]; // array of valid weapons

io.on("connection", function(socket) {
  console.log("A user connected");
  
  // add new player to array
  players.push(socket.id);
  
  // if there are two players, start the game
  if (players.length == 2) {
    var player1 = players[0];
    var player2 = players[1];
    players = []; // reset array for next game
    
    console.log("Starting game between " + player1 + " and " + player2);
    
    // emit message to both players to choose a weapon
    io.to(player1).emit("message", "Choose your weapon.");
    io.to(player2).emit("message", "Choose your weapon.");
    
    // listen for weapons from both players
    socket.on("weapon", function(weapon) {
      // validate weapon
      if (weapons.indexOf(weapon) == -1) {
        socket.emit("message", "Invalid weapon. Please choose again.");
      } else {
        socket.weapon = weapon;
        
        // if both players have chosen a weapon, determine the winner
        if (io.sockets.adapter.rooms[player1] && io.sockets.adapter.rooms[player2]) {
          var player1Weapon = io.sockets.connected[player1].weapon;
          var player2Weapon = io.sockets.connected[player2].weapon;
          
          if (player1Weapon == player2Weapon) {
            io.to(player1).emit("result", "Tie!");
            io.to(player2).emit("result", "Tie!");
          } else if ((player1Weapon == "rock" && player2Weapon == "scissors") ||
                     (player1Weapon == "paper" && player2Weapon == "rock") ||
                     (player1Weapon == "sc

